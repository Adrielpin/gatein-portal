<!--

    Copyright (C) 2009 eXo Platform SAS.
    
    This is free software; you can redistribute it and/or modify it
    under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation; either version 2.1 of
    the License, or (at your option) any later version.
    
    This software is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    Lesser General Public License for more details.
    
    You should have received a copy of the GNU Lesser General Public
    License along with this software; if not, write to the Free
    Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
    02110-1301 USA, or see the FSF site: http://www.fsf.org.

-->

<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook V4.4//EN" "http://www.oasis-open.org/docbook/sgml/4.4/docbookx.dtd">
<section>
	<title>Javascript Configuration</title>
	<para>Manaing Javascript scripts in an application like GateIn
		Platform is a critical part of the configuration work if you want to
		get good response time.</para>
	<para>Every portlet can have its own javscript code but in many
		cases it is more convenient to reuse some existing shared libraries.
		For that reason, GateIn has a mechanism to easily register the
		libraries that will be loaded when the first page will be rendered. To
		do so, every WAR deployed in GateIn can register the js files thanks
		to a groovy script &quot;WEB-INF/conf/script/groovy/JavascriptScript.groovy&quot;. The next file is the one you can find in the GateInResources.war</para><programlisting>JavascriptService.addJavascript(&quot;GateIn&quot;, &quot;/javascript/GateIn.js&quot;, ServletContext);
/* Animation Javascripts */
JavascriptService.addJavascript(&quot;GateIn.animation.ImplodeExplode&quot;, &quot;/javascript/GateIn/animation/ImplodeExplode.js&quot;, ServletContext);
/* Application descriptor */
JavascriptService.addJavascript(&quot;GateIn.application.ApplicationDescriptor&quot;, &quot;/javascript/GateIn/application/ApplicationDescriptor.js&quot;, ServletContext);
/* CORE Javascripts */
JavascriptService.addJavascript(&quot;GateIn.core.Utils&quot;, &quot;/javascript/GateIn/core/Util.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.core.DOMUtil&quot;, &quot;/javascript/GateIn/core/DOMUtil.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.core.Browser&quot;, &quot;/javascript/GateIn/core/Browser.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.core.MouseEventManager&quot;, &quot;/javascript/GateIn/core/MouseEventManager.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.core.UIMaskLayer&quot;, &quot;/javascript/GateIn/core/UIMaskLayer.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.core.Skin&quot;, &quot;/javascript/GateIn/core/Skin.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.core.DragDrop&quot;, &quot;/javascript/GateIn/core/DragDrop.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.core.TemplateEngine&quot;, &quot;/javascript/GateIn/core/TemplateEngine.js&quot;, ServletContext);
/* Widget Javascripts */
JavascriptService.addJavascript(&quot;GateIn.widget.UIWidget&quot;, &quot;/javascript/GateIn/widget/UIWidget.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.widget.UIAddWidget&quot;, &quot;/javascript/GateIn/widget/UIAddWidget.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.widget.UIExoWidget&quot;, &quot;/javascript/GateIn/widget/UIExoWidget.js&quot;, ServletContext);
/* Desktop Javascripts */
JavascriptService.addJavascript(&quot;GateIn.desktop.UIDockbar&quot;, &quot;/javascript/GateIn/desktop/UIDockbar.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.desktop.UIDesktop&quot;, &quot;/javascript/GateIn/desktop/UIDesktop.js&quot;, ServletContext);
/* WebUI Javascripts */ 
JavascriptService.addJavascript(&quot;GateIn.webui.UIItemSelector&quot;, &quot;/javascript/GateIn/webui/UIItemSelector.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIForm&quot;, &quot;/javascript/GateIn/webui/UIForm.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIPopup&quot;, &quot;/javascript/GateIn/webui/UIPopup.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIPopupSelectCategory&quot;, &quot;/javascript/GateIn/webui/UIPopupSelectCategory.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIPopupWindow&quot;, &quot;/javascript/GateIn/webui/UIPopupWindow.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIVerticalScroller&quot;, &quot;/javascript/GateIn/webui/UIVerticalScroller.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIHorizontalTabs&quot;, &quot;/javascript/GateIn/webui/UIHorizontalTabs.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIPopupMenu&quot;, &quot;/javascript/GateIn/webui/UIPopupMenu.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.webui.UIDropDownControl&quot;, &quot;/javascript/GateIn/webui/UIDropDownControl.js&quot;, ServletContext);
/* Portal Javascripts */ 
JavascriptService.addJavascript(&quot;GateIn.portal.PortalHttpRequest&quot;, &quot;/javascript/GateIn/portal/PortalHttpRequest.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.portal.UIPortal&quot;, &quot;/javascript/GateIn/portal/UIPortal.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.portal.UIWorkspace&quot;, &quot;/javascript/GateIn/portal/UIWorkspace.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.portal.UIPortalControl&quot;, &quot;/javascript/GateIn/portal/UIPortalControl.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.portal.PortalDragDrop&quot;, &quot;/javascript/GateIn/portal/PortalDragDrop.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.portal.UIPortalNavigation&quot;, &quot;/javascript/GateIn/portal/UIPortalNavigation.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.portal.UIMaskWorkspace&quot;, &quot;/javascript/GateIn/portal/UIMaskWorkspace.js&quot;, ServletContext);
JavascriptService.addJavascript(&quot;GateIn.portal.UIExoStartMenu&quot;, &quot;/javascript/GateIn/portal/UIExoStartMenu.js&quot;, ServletContext);
/* Desktop Javascripts 2 */
JavascriptService.addJavascript(&quot;GateIn.desktop.UIWindow&quot;, &quot;/javascript/GateIn/desktop/UIWindow.js&quot;, ServletContext);
</programlisting><para>Note that even if the you register dedicated javascripts, they will be merged into a single <literal>merged.js</literal> file when the server will load in order to reduce the number of HTTP calls as seen in the home page source code:</para><programlisting>    &lt;script type=&quot;text/javascript&quot; src=&quot;/portal/javascript/merged.js&quot;&gt;&lt;/script&gt;
</programlisting><para>Although this optimization is useful for a production environment, you may find it easier to deactivate this optimization while debugging your javascript. For that, you simply need to set the java system property <literal>exo.product.developing</literal> to <literal>true</literal>. But if you <emphasis>want to see or use the merged file</emphasis> you have to set this property to <literal>false</literal>. You can pass the property as a JVM parameter with the <literal>-D</literal> option in your <literal>GateIn.sh</literal> or <literal>GateIn.bat</literal> startup script: {code} EXO{code}</para><para>Every javascript file is referenced with a module name of type &quot;GateIn.core.DragDrop&quot; which acts like a namespace. Inside the associated files, global javascript functions are used following the same namespace convention:</para><programlisting>GateIn.core.DragDrop = new DragDrop() ;
</programlisting><para>It is also possible to use the GateIn.require() javascript method to lazy load and evaluate some javascript code. This is quite useful from the portlet or widget applications that will use this javascript only once. Otherwise, if the library is reusable in several places it is better to reference it in the groovy file.</para>
</section>