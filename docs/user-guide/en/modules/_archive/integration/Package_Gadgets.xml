<!--

    Copyright (C) 2009 eXo Platform SAS.
    
    This is free software; you can redistribute it and/or modify it
    under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation; either version 2.1 of
    the License, or (at your option) any later version.
    
    This software is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    Lesser General Public License for more details.
    
    You should have received a copy of the GNU Lesser General Public
    License along with this software; if not, write to the Free
    Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
    02110-1301 USA, or see the FSF site: http://www.fsf.org.

-->

<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook V4.4//EN" "http://www.oasis-open.org/docbook/sgml/4.4/docbookx.dtd">
<section>
	<title>Package Gadgets</title>
	<section>
		<title>Overview</title>
	</section>
	<para>The gadgets can be packaged in a war to be automatically
		deployed in the portal. They are described in a gadgets.xml file that
		is stored in the WEB-INF of the webapp. To have this file recognized
		by the portal, you need to add a listener to your webapp.</para>
	<section>
		<title>Examples</title>
	</section>

	<section>
		<title>Folder hierarchy</title>
	</section>
	<itemizedlist>
		<listitem>
			MyGadgets
			<itemizedlist>
				<listitem>
					gadgets
					<itemizedlist>
						<listitem>Todo.xml</listitem>
						<listitem>
							Todo
							<itemizedlist>
								<listitem>script.js</listitem>
								<listitem>style.css</listitem>
							</itemizedlist>
						</listitem>
					</itemizedlist>
				</listitem>
				<listitem>
					WEB-INF
					<itemizedlist>
						<listitem>gadget.xml</listitem>
						<listitem>web.xml</listitem>
					</itemizedlist>
				</listitem>
			</itemizedlist>
		</listitem>
	</itemizedlist>
	<section>
		<title>gadget.xml</title>
	</section>
	<programlisting>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;gadgets&gt;
	&lt;gadget name=&quot;Todo&quot;&gt;
		&lt;path&gt;/gadgets/Todo.xml&lt;/path&gt;
	&lt;/gadget&gt;
	
	&lt;gadget name=&quot;Weather&quot;&gt;
		&lt;url&gt;http://www.labpixies.com/campaigns/weather/weather.xml&lt;/url&gt;
	&lt;/gadget&gt;
&lt;/gadgets&gt;
</programlisting><para>If the gadget is a local gadget (using the xml tag <emphasis role="bold">path</emphasis>), the gadget is copied in the JCR. If a directory has the same name as the gadget, this one is copied as well. In our sample, it will copy the directory Todo and all the files in it to the JCR.</para><para>If the gadget is a remote gadget (using the tag <emphasis role="bold">url</emphasis>), we store the url, and the gadget is not copied into the JCR. The server will only cache the gadget according to the information in the http header.</para><para>1.1 web.xml {code:xml} &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</para><para>&lt;!DOCTYPE web-app PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot; &quot;http://java.sun.com/dtd/web-app<emphasis>2</emphasis>3.dtd&quot;&gt;</para><para>&lt;web-app&gt; &lt;display-name&gt;my Gadgets&lt;/display-name&gt; &lt;listener&gt; &lt;listener-class&gt;org.exoplatform.application.gadget.GadgetRegister&lt;/listener-class&gt; &lt;/listener&gt;</para><para>&lt;/web-app&gt; {code}</para>
<section><title>Example of GateInGadgets</title></section>
<itemizedlist><listitem><ulink url="http://svn.exoplatform.org/svnroot/exoplatform/projects/portal/trunk/gadgets/GateInGadgets/">http://svn.exoplatform.org/svnroot/exoplatform/projects/portal/trunk/gadgets/GateInGadgets/</ulink></listitem></itemizedlist>
</section>