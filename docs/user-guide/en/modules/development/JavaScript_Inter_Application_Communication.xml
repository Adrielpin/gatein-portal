<!--

    Copyright (C) 2009 eXo Platform SAS.
    
    This is free software; you can redistribute it and/or modify it
    under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation; either version 2.1 of
    the License, or (at your option) any later version.
    
    This software is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    Lesser General Public License for more details.
    
    You should have received a copy of the GNU Lesser General Public
    License along with this software; if not, write to the Free
    Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
    02110-1301 USA, or see the FSF site: http://www.fsf.org.

-->

<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook V4.4//EN" "http://www.oasis-open.org/docbook/sgml/4.4/docbookx.dtd">
<section>
	<title>JavaScript Inter Application Communication</title>
	<section>
		<title>Overview</title>
	</section>
	<para>This kind of communication is made to allow applications
		within a page to exchange data. This library is made for broadcasting
		messages on topic. This is basically based on 3 functions : subscribe,
		publish and unsubscribe.</para>
	<para>When you subscribe to a topic, you receive all the subtopic
		message. for example, if I subscribe to &quot;/GateIn/application&quot;, and an application send a message on &quot;/GateIn/application/map&quot;, i will receive it, but if another application send a message on &quot;/GateIn&quot;, i will not receive it.</para>
<section><title>Common topics</title></section>

<section><title>/GateIn</title></section>
<para>It contains all the events generated by the platform.</para>
<section><title>/GateIn/portal/notification</title></section>
<para>When a message is sent on this topic, a popup message appears on the top right of the screen.</para>
<section><title>/GateIn/portal/changeTitle (not implemented yet)</title></section>
<para>Send a message on this channel to change (and to be notified) the title of the portal.</para>
<section><title>/GateIn/portal/pageLoaded (not implemented yet)</title></section>
<para>Receive a message when a page is loaded.</para>
<section><title>/GateIn/portal/pageUnloaded (not implemented yet)</title></section>
<para>Receive a message when a page is unloaded.</para>
<section><title>/GateIn/application/applicationLoaded (not implemented yet)</title></section>
<para>Receive a message when an application is loaded in the page.</para>
<section><title>/GateIn/application/applicationUnloaded (not implemented yet)</title></section>
<para>Receive a message when an application is unloaded in the page.</para>
<section><title>Library</title></section>
<para>The inter application communication http://fisheye.exoplatform.org/projects/browse/projects/portal/trunk/web/GateInResources/src/main/webapp/javascript/GateIn/core/Topic.js</para>
<section><title>Syntax</title></section>
<programlisting>subscribe is used to subscribe a callback to a topic
*Parameters:*
* topic is the topic that will be listened
* obj is the context object
* funcName is the name of the function of obj to call when a message is received on the topic
funcName have to be a function that take an Object in parameter. the event received have this format: 
{code:javascript}
{
  senderId:senderId,
  message:message,
  topic: topic
}
</programlisting><programlisting>publish is used to publish an event to the other subscribers to the given channels
*Parameters:*
* senderId is a string that identify the sender
* topic is the topic that the message will be published
* message is the message that's going to be delivered to the subscribers to the topic
</programlisting><para>unsubscribe is used to unsubscribe a callback to a topic</para><itemizedlist><listitem>Parameters:</listitem><listitem>topic is the topic that will be unsubscribe</listitem><listitem>obj is the context object</listitem><listitem>funcName function name givent at the previous subscribe</listitem></itemizedlist>
<section><title>Example</title></section>
<para><ulink url="http://fisheye.exoplatform.org/projects/browse/projects/portal/trunk/sample/application/topic/src/main/webapp/WEB-INF/script.jsp?r=11474">Topic Demo</ulink></para>
</section>